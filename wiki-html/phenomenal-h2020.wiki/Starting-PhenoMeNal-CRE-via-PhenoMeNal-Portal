<h1>What is PhenoMeNal?</h1>

<p>A <a href="https://en.wikipedia.org/wiki/Phenotype">Phenotype</a> is a set of observable characteristics of an organism and is the result of the genetic makeup as well as influence of the external environmental factors. Metabolic phenotyping or the measuring and modelling of the profile of all metabolites of an individual, provides insights into disease risk factors and etiology, an information that can be used for personalised medicine. <strong>PhenoMeNal</strong> is a comprehensive and standardised e-infrastructure that supports data processing and analysis workflows for such  molecular phenotype data generated by metabolomics studies. This will allow us to improve our ability to monitor health and to detect, treat and manage diseases. The infrastructure is generic and can be used for other ‘omics studies and non-clinical applications if needed.</p>

<h2>PhenomeNal Tools and Workflows</h2>

<p>PhenoMeNal provides access to popular analysis tools such as XCMS, rNMR, IPO, Workflow4Metabolomics and MetFrag among many others tools in <a href="https://en.wikipedia.org/wiki/Metabolomics">metabolomics</a>, and combines them with the computing power of the <a href="https://en.wikipedia.org/wiki/Cloud_computing">cloud environment</a>. All of these is exposed to the end user through the ease of use of graphical <a href="https://en.wikipedia.org/wiki/Bioinformatics_workflow_management_system">workflow environment</a> tools.</p>

<p><img src="./images/cre/1.png" alt="The PhenoMeNalGateway homepage is easily accessible by clicking on the Portal tab of the menu panel on the PhenoMeNal website." /></p>

<p><strong>Figure 1</strong> The PhenoMeNalGateway homepage is easily accessible by clicking on the Portal tab of the menu panel on the <a href="http://phenomenal-h2020.eu/home/">PhenoMeNal website</a>.</p>

<h1>Why do we need PhenoMeNal?</h1>

<p>When trying to do computational data analysis, researchers will often confront the difficult reality of having to install complex pieces of scientific software and their dependencies, and setup intricate methods of connecting those tools together, having to deal with data standards handling and data transformations. This normally requires a high level of expertise in bioinformatics that most data producers don’t have access to. PhenoMeNal aims to bridge that technical gap by providing an automatic way of setting up a plethora of metabolomics software. </p>

<p><img src="./images/cre/2.png" alt="Note" /></p>

<h2>Examples of why we need PhenoMeNal</h2>

<h3>Programming expertise</h3>

<h4>Problem:</h4>

<p>No programming experience</p>

<h4>PhenoMeNal solution:</h4>

<p>It allows user with no programming experience to put many of these tools together in pipelines, through a proven workflow environment (Galaxy) that has been used successfully in other fields of life sciences for more than 10 years now.</p>

<h3>Computational complexities  and associated costs</h3>

<h4>Problem:</h4>

<p>Complex installations</p>

<h4>PhenoMeNal solution:</h4>

<p>PhenoMeNal provides a scalable infrastructure which helps the user to abstract the complexity of setting up a computer cluster, networks, security, etc. In essence, you get your own cluster with the software you need preinstalled to do metabolomics data analysis.</p>

<h3>Problem:</h3>

<p>Extreme data volumes and data transfers</p>

<h3>PhenoMeNal solution:</h3>

<p>Bring the compute to the data: often people take their data to a collaborator’s computer cluster for data analysis, where all tools have been previously installed. In a world of growing a growing cohorts, where data grows larger and larger, moving data around becomes more and more complex. PhenoMeNal reverts this paradigm, by allowing users to put the compute infrastructure next to where the data is.</p>

<h3>Problem:</h3>

<p>Vendor lock-in</p>

<h3>PhenoMeNal solution:</h3>

<p>When going through a public cloud provider, like Amazon AWS or Google GCE, PhenoMeNal provides the  ability to run data analysis in as few or as many machines you require to be able to timely analyze your data.</p>

<h1>Source of data in PhenoMeNal</h1>

<p>PhenoMeNal is an e-infrastructure for managing, preserving and computing with metabolomic and other ‘omics data. All research data will essentially be the data deposited by the users or the data providers. </p>

<p><img src="./images/cre/3.png" alt="fig2" /></p>

<p><strong>Figure 2</strong>  PhenoMeNal uses and provides help to pre-package data from the user. </p>

<h1>How can PhenoMeNal help with your research</h1>

<h2>When to use PhenoMeNal</h2>

<p>You can use PhenoMeNal:</p>

<ul>
<li><p>As an easy to use, cloud based scalable software infrastructure for metabolomic research.</p></li>
<li><p>To Analyse your metabolomic data using tools from the PhenoMeNal App Library within a workflow environment such as Galaxy.</p></li>
<li><p>For reproducible research.</p></li>
</ul>

<p><img src="./images/cre/4.png" alt="note1" /></p>

<h1>When not to use PhenoMeNal</h1>

<h2>PhenoMeNal cannot help you if you:</h2>

<ul>
<li>Want to use any kind of cloud services for purposes other than metabolomics data analysis. For this, you need to visit some cloud providers for further information.</li>
</ul>

<h2>Limitations:</h2>

<ul>
<li><p>Size of the data uploaded in the sponsored PhenoMeNal instance; You can upload more data on an instance created with your credit on a cloud provider, or within your institutions OpenStack installation (a private cloud provider).</p></li>
<li><p>If an app is not in the App Library, then you won’t find it in the PhenoMeNal Galaxy installation. With some joint effort, we can make those tools available and we provide extensive documentation for external developers for migrate new tools to the PhenoMeNal architecture.</p></li>
<li><p>If you’re data uses non-standard formats, it might require some additional data transformation steps that depend on other tools which probably are not available in PhenoMeNal. </p></li>
</ul>

<h1>How to deploy PhenoMeNal CRE</h1>

<ol>
<li><p>You can create your CRE instance on a cloud provider of your choice by clicking the ‘Create Cloud Research Environment’ at the index page, or click on “Galaxy workflow” to create your workflow in a cloud environment.</p>

<p><img src="./images/cre/5.png" alt="figure5" /></p>

<p><strong>Figure 5</strong> PhenoMeNal Gateway homepage</p>

<p><img src="./images/cre/6.png" alt="note2" /></p></li>
<li><p>Sign to deploy the CRE via Elixir Single Sign-On (SSO) using your existing ORCID, LinkedIn or Google account credentials to login. Alternately sign in using your institutional account. </p>

<p><img src="./images/cre/7.png" alt="figure7" /></p>

<p><strong>Figure 7</strong> Elixir Single Sign-On Page</p>

<p><img src="./images/cre/8.png" alt="figure8" /></p></li>
<li><p>Select your Cloud provider</p>

<p>Select your cloud provider  for the CRE deployment. You can chose to use PhenoMeNal Cloud, the free cloud service, to create your own CRE. </p></li>
</ol>

<h2>Deployment Alternative 1: PhenoMeNal sponsored CRE$</h2>

<ol>
<li><p>Click on the “Select” button to deploy your CRE on the free PhenoMeNal cloud</p>

<p><img src="./images/cre/9.png" alt="figure9" /></p>

<p><strong>Figure 8</strong> Setup CRE using the free PhenoMeNal Cloud.</p></li>
<li><p>Click “Register”</p>

<p><img src="./images/cre/10.png" alt="figure10" /></p></li>
<li><p>Create a user and password for your new user at the PhenoMeNal deployed CRE (at one of the partners installations).</p>

<p><img src="./images/cre/11.png" alt="figure11" /></p></li>
<li><p>Login to enter the PhenoMeNal deployed Galaxy instance.</p>

<p><img src="./images/cre/12.png" alt="figure12" /></p></li>
</ol>

<h2>Deployment Alternative 2: Amazon AWS</h2>

<p>This alternative requires that you have an Amazon AWS account with credit. Please make sure to switch off the deployment once you are done using it, otherwise this will continue to use your Amazon AWS credit. Follow the directions in the available in the Figures ahead to deploy a PhenoMeNal VRE to Amazon AWS. You will first select the AWS as your desired provider, then enter your AWS credentials, define an Admin user for your Galaxy instance, and finally launch the deployment process.</p>

<ol>
<li><p>Click on Amazon Web services to deploy using your credentials .</p>

<p><img src="./images/cre/13.png" alt="figure13" /></p>

<p>Press select below the Amazon Web Services box.</p></li>
<li><p>Enter your Amazon AWS Access Key ID and Secret Access Key</p>

<p><img src="./images/cre/14.png" alt="figure14" /></p>

<p>Enter your Amazon AWS Access Key ID and Secret Access Key. If you have an account with Amazon AWS, but you don’t know how to get these access tokens, please see the following link: <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html#Using_CreateAccessKey">http://docs.aws.amazon.com/IAM/latest/UserGuide/id<em>credentials</em>access-keys.html#Using_CreateAccessKey</a>. After that, select the region where you want to deploy.</p>

<p><img src="./images/cre/15.png" alt="figure15" /></p>

<p>In order to secure the Galaxy instance that will be deployed within your CRE in Amazon AWS, you need to provide an email to create the account of the Galaxy administrator user, and setup the password for this user. You need to keep track of these details, as you will need them to log-in into the Galaxy instance deployed for you. With this user you will be able to administer the instance and create more users if needed.</p></li>
</ol>

<h1>Deployed PhenoMeNal Galaxy Instance</h1>

<p>If you have gone through one of the two available options. The PhenoMeNal Galaxy installation consists of set of tools available through a workflow environment.  </p>

<p>You will first need to login to the PhenoMeNal CRE deployed Galaxy instance, with the credentials that you gave in the previous steps. Go to the User drop-down menu on the top bar, as shown in Figure loginPhenoGalaxy, and select the Login option in the menu.</p>

<p><img src="./images/cre/16.png" alt="figure16" /></p>

<p>Find the User drop-down menu as shown, and click on the Login option to start the login. Notice that the branding can change a bit depending on where and when the instance of Galaxy was deployed. Note that the Workflow and Visualization drop-down menus are disabled before login.</p>

<p>Presented with the login prompt, enter the email used to create your account at the CRE Portal </p>

<p><img src="./images/cre/17.png" alt="figure17" /></p>

<p>Enter the user and password previously used on registration.</p>

<p>Please note at this point that a Galaxy instance running on the PhenoMeNal sponsored CRE deployment is not meant for large scale data analysis, but for you to do some analysis within the infrastructure with data remaining in the system for a longer while than the other public instance open to the public. The PhenoMeNal sponsored CRE is not meant for sensitive or private data, so you should not upload that kind of data there. If you are not using the PhenoMeNal sponsored CRE but a deployment on your Amazon AWS account, then this does not apply of course.</p>

<p><img src="./images/cre/18.png" alt="figure18" /></p>

<p><strong>Figure 8</strong> Galaxy CRE: After a succesful login, you should be able to upload data</p>

<p>Although many things work differently in the backstage of a PhenoMeNal Galaxy instance compared to other Galaxy instances, the usability and user experience is the same. As such, to familiarise yourself on how to make best use of the PhenoMeNal Galaxy CRE we can recommend the following guided Galaxy Tours:
<a href="https://usegalaxy.org/tours">https://usegalaxy.org/tours</a>
These will give you a walkthrough the Galaxy user interface, the same used by the PhenoMeNal Galaxy CRE. After you go through those tours, you should feel comfortable to start trying the PhenoMeNal Galaxy CRE with our tools.</p>

<h1>PhenoMeNal App Library</h1>

<h2>Browsing the  PhenoMeNal App Library</h2>

<p>The PhenoMeNal application library referred to as the “App Library” is a service catalogue providing a list of tools contained within the PhenoMeNal CRE. These tools are available via Galaxy workflows and Jupyter libraries.</p>

<p>To search for a metabolomics analysis tool, type the name of the tool in the search box. You can also filter your results on the basis of functionality, approach, and Instrument data type by checking the boxes of the search tree on the left</p>

<p><img src="./images/cre/19.png" alt="figure19" /></p>

<p><strong>Figure 9</strong> App Library listing the available tools</p>

<h1>When to use Galaxy VRE: guided examples</h1>

<ol>
<li><p>This section shows you how to use Galaxy VRE. First, open the Galaxy VRE. If this is your first time in the Galaxy VRE,  you need to register your account. Otherwise, please login with your registered account (Figure 12).</p>

<p><img src="./images/cre/20.png" alt="figure20" /></p>

<p><strong>Figure 12</strong> Galaxy Walkthrough - Login and Register</p></li>
<li><p>The Galaxy Homepage page is divided into three columns (Figure 13). On the right hand side, you will see the history of the system. On the left hand side, you will see a various tools available. On the top, you will find the action bar that allows you to do various activities within Galaxy VRE using your own data. </p>

<p><img src="./images/cre/21.png" alt="figure21" /></p>

<p><strong>Figure 13</strong> Galaxy Walkthrough - main page</p></li>
<li><p>Create a workflow using Galaxy</p>

<p>a. On the top menu, select ‘Shared data’, from the dropdown menu, select ‘HIstories’.
<img src="./images/cre/22.png" alt="figure22" /></p>

<p>b. From available data set, click on ‘w4m-sacurine-statistics’ (Figure 14). It might take a while to load, please be patient.</p>

<p><img src="./images/cre/23.png" alt="figure23" /></p>

<p><strong>Figure 14</strong> Galaxy Walkthrough - data loading</p>

<p>The page displayed shows the public history of the data set (Figure 15). 
    - To view each section, click on the eye symbol. 
    - To download the data, click on hyperlink of each data set. 
    <img src="./images/cre/24.png" alt="figure24" /></p>

<pre><code>**Figure 15** Galaxy Walkthrough - data loading

![figure25](./images/cre/25.png)

**Figure 16** Results page for data display
</code></pre></li>
<li><p>In order to analyse this data, you will need to make a copy of your data set in your own Galaxy VRE account. To this, click on the ‘Import history’ link. Click the title of the pop-up dialogue, change the title, then click on ‘Import’.</p></li>
</ol>

<p>You will notice you will a list of history on the right hand side to be edited if you wish to. You can click on one of the history items and click on the visualisation button (Figure 17). You will be able to see visualisation of the data set.</p>

<p><img src="./images/cre/26.png" alt="figure26" /></p>

<p><strong>Figure 17</strong> Galaxy Walkthrough - data download</p>

<h1>Summary</h1>

<h2>What is PhenoMeNal?</h2>

<p>PhenoMeNal is a comprehensive and standardised e-infrastructure that supports the data processing and analysis pipelines for molecular phenotype data generated by metabolomics applications. </p>

<h2>Why use PhenoMeNal?</h2>

<p>The accumulation of unprecedented numbers of high dimensional and increasingly complex datasets covering Metabolic  Phenotyping, personal genomes and other data, offers great promise for capturing subtle and complex biologically imprinted effect of accumulated exposure (exposome) on health. Processing and analysis of such data, however, requires advanced computation and data management.</p>

<h2>What tools are provided?</h2>

<p>PhenoMeNal provides wide range of metabolomics tools (29 tools and counting). For further information, please visit http://portal.phenomenal-h2020.eu/app-library</p>

<h2>How to access PhenoMeNal?</h2>

<p>PhenoMeNal can be accessed via the PhenoMeNal Gateway http://portal.phenomenal-h2020.eu/</p>

<h2>How can I download PhenoMeNal data?</h2>

<p>You can download PhenoMeNal data through MetaboLights Labs Downloader from Galaxy VRE. The tool can produce both Zipped and individual versions of MAF (Metabolite Annotation File) and ISA files, for different downstream usages in Galaxy, as well as a TAR archive file containing all the data files obtained from MetaboLights for that study. By default, these files are only visible to the user that downloaded them; they need to be actively shared to become visible to other users within Galaxy.</p>

<h2>How can I upload PhenoMeNal data?</h2>

<p>You can upload PhenoMeNal data through MetaboLights Labs Uploader from Galaxy VRE. The user can select data from files available in their Galaxy history for upload. When uploading, the user can either create a new Project within the MetaboLights Labs Workspace or provide the Project ID for an existing Labs Project to add more data. </p>

<h1>References</h1>

<ul>
<li>Rocca-Serra, P., Salek, R.M., Arita, M., Correa, E., Dayalan, S., Gonzalez-Beltran A., Ebbels T. et al. (2016) Data standards can boost metabolomics research, and if there is a will, there is a way. Metabolomics, 12(1):14. DOI: 10.1007/s11306-015-0879-3</li>
<li>Merlet, B., Paulhe N., Vinson, F., Frainay, C., Chazalvie,l M., Poupin, N., Gloaguen, Y. et al. (2016) A Computational Solution to Automatically Map Metabolite Libraries in the Context of Genome Scale MetabolicNetworks. Front Mol Biosci., Feb 16; 3:2. DOI:  10.3389/fmolb.2016.00002</li>
<li>Blaise, B.J., Correia, G., Tin, A., Young, J.H., Vergnaud, A.C., Lewis, M., Pearce, J.T.  et al. (2016) Power Analysis and Sample Size Determination in Metabolic Phenotyping. Anal Chem. May 17; 88(10): 5179-88. DOI:10.1021/acs.analchem.6b00188</li>
<li>Saccenti, E., Menichetti, G., Ghini, V., Remondini, D., Tenori, L., and Luchinat, C. (2016) Entropy–Based Network Representation of the Individual Metabolic Phenotype. J Proteome Res. Sep 2; 15(9): 3298-307. DOI:10.1021/acs.jproteome.6b00454</li>
<li>Karaman, I., Ferreira, D.L., Boulange, C.L., Kaluarachchi, M.R., Herrington, D., Dona, A.C, Castagné, R. et al. (2016) A Workflow For Integrated Processing of Multi-Cohort Untargeted 1H NMR Metabolomics Data In Large ScaleMetabolic Epidemiology. J Proteome Res. 2016 Sep 15. DOI: 10.1021/acs.jproteome.6b00125</li>
</ul>

<h1>Contributors</h1>

<h2>Namrata Kale</h2>

<p>Namrata S. Kale obtained her PhD in natural product chemistry from Indian Institute of Technology, New Delhi, India. She is currently a member of the Cheminformatics and Metabolism group at EMBL-EBI, where she works as a Project Manager for PhenoMeNal</p>

<h2>Sijin He</h2>

<p>Dr. Sijin He received a BSc in Mathematics (1st Class Hon) from University College London in 2007 and a MSc in Computing Science from Imperial College London in 2008. In August 2013, he received PhD in Computer Science at Imperial College London on cloud computing. He worked as a postdoctoral research in Data Science Institute. He is currently working as a full-stack software developer for PhenoMeNal H2020 project at EMBL-EBI. </p>

<h2>Pablo Moreno</h2>
